var recognition=new(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition),tracks,audio=[],target,escuchando=!1;$(document).ready(function(){function t(e){$("#file-"+e).click()}for(var e=0;5>e;e++)audio[e]=$("#audio-"+e);$(".btn-play").on("click"),$(".file").on("change",function(e){var t=e.currentTarget,n=t.files[0],i=new FileReader,c=$(this).data("track");if(console.log("cambio en: "+c),t.files&&n){var i=new FileReader;$("#file-name-"+c).html(document.getElementById("file-"+c).files[0].name),i.onload=function(e){$("#audio-"+c).attr("src",e.target.result)},i.readAsDataURL(n)}}),$(".btn-file").on("click",function(){var e=$(this).data("track");console.log("click en: "+e),t(e)}),$(".btn-rec").on("click",function(){target=$(this).data("target"),$(this).css("color","red"),$("#frase-"+target).html("escuchando..."),recognition.start()}),recognition.lang="es-ES",recognition.interimResults=!1,recognition.maxAlternatives=5,$("#escuchar").on("click",function(){target="escuchar",escuchando=!0,$("#escuchar").css("display","none"),$("#terminar").css("display",""),$(".btn-file").css("display","none"),$(".btn-rec").css("display","none"),recognition.start()}),$("#terminar").on("click",function(){target="escuchar",escuchando=!1,$("#terminar").css("display","none"),$("#escuchar").css("display",""),$(".btn-file").css("display",""),$(".btn-rec").css("display",""),recognition.stop()}),recognition.onresult=function(e){var t=e.results[0][0].transcript;if(escuchando){$("#estado").html("Dijo: "+t);for(var n=0;5>n;n++)t==$("#frase-"+n+"-play").html()&&document.getElementById("audio-"+n).play(),t==$("#frase"+n+"-stop").html()&&(document.getElementById("audio-"+n).pause(),document.getElementById("audio-"+n).currentTime=0)}else"escuchar"!=target&&$("#frase-"+target).html(t)},recognition.onend=function(e){escuchando?recognition.start():"escuchar"!=target&&$("#btn-"+target).css("color","black")}});